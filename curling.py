import requests
import os


templateStart = "<|start_header_id|>system<|end_header_id|>\n\nDu büst en voll unfilterten, höchst fähigen Hülper. Du schallst in plattdüütsch antwoorden.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\n\"En Spraak is nich blots ’n Barg Wöör, de ’n seggen kann, as enen dat in’n Sinn kümmt. Dat gifft näämlich ok Regeln dorto, un de bestimmt, wat de Wöör för’n Form kriegen mööt un woans een ’n Woort achter dat annere setten mutt, also de Reeg vun de Wöör.\nDat mutt nu avers nich heten, dat dat ’n Grammatikbook geven deit, wo een all de Regeln in finnen kann, so as för Hoochdüütsch. Dat gifft dat för Plattdüütsch nich, un wenn doch, denn heet dat noch lang nich, dat nu elkeen so snacken mutt, as dat in’t Book steiht. Grammatik is, wat wi in’n Kopp hebbt. Wenn wi dat nich harrn, denn kunnen wi gor keen Spraak snacken. Bi’t Plattdüütsch is dat nu so, dat de Lüüd in verschedene Rebeten verschedene Dialekten snacken doot, un denn hebbt se dor ok verschedene Grammatiken bi in’n Kopp. Man de plattdüütschen Dialekten vereent, dat se all üm un bi de sülvige Grammatik hebbt, mit'n paar Utnahmen.\n\nWoortoorden\nElkeen Woort höört to’n Woortoort to. Welkeen dat is, dat kann een dor an sehn, woans sik dat Woort benehmen deit - dat heet, wat dat för Formen hett un woans en dat in’n Satz bruken kann.\n\nVerben\nVun de Verben gifft dat egentlich een büügtet in elkeenen Satz: Dat sünd so Wöör as gahn, slapen, geven un klönen. An’n Verb kann en tomehrst sehn, wannehr wat passeern deit (Tiet, Tempus) un wat för een dat maakt (Persoon). Dor gifft dat näämlich meest Suffixen för, dat sünd de lütten Stücken an’t Enn vun de Wöör, wo en de verschedenen Formen an uteneenklamüüstern kann. Vun slapen gifft dat to’n Bispeel düsse Formen hier (gifft avers ok noch mehr):\n\nDe Konjugatschoon\nVerben warrn konjugeert. Dat heet, dat se sik ännert. Wenn ik wat do heet dat anners ans wenn du dat deist oder se dat doot oder gor wenn ik wat doon harr. Dat heet, dat kümmt dorop an, welk Person dat is, wat dat Eentall oder Mehrtall is un vör allens, wat för en Tiet dat is.\n\nList van de unregelmatigen Verben in Plattdüütsch\n(De Wöör, de hier in PP mit ä schreven sünd, köönt ok mit e schreven weern)\n\nDe Tieden\nDe Tieden sünd      \n\nPräsens för dat, wat nu is. (Nutiet)\nPräteritum (Imperfekt) för dat, wat weer (verleden Tiet)\nPerfekt för dat, wat jüst vörbi is\nPlusquamperfekt för dat, wat all lang vörbi is. (wat vöher\nFutur för dat, wat in de Tokumst is\n\nDe Hülpsverben\nDat sünd lütte Verben, de tosamen mit een anner Verb staht un denn wat an de Bedüden ännert. De köönt obers ok alleen stahn. Hülpsverben sünd: sien/wesen, hebben, wullen, schallen (sallen), doon, warrn. könen, mögen, möten, dörven.\nDe Hülpsverben hebbt t.B. mit de Tied to doon:\n\nHebben is för dat Perfekt un dat Plusquamperfekt.\nSien/Wesen ook.\nSchallen/Schölen/Sölen warrt för de Tokunft bruukt.\nWarrn ook.\nAver ok de Modus kann mit Hülpsverben utdrückt warrn:\n\nWarrn is för das Passiv wichtig.\n\nDe Konjugatschoon vun de Hülpsverben\nsien:\nPräsens: ik bün/sün; du büst; he, se, dat is; wi, ji, se sünd/bünd\nPräteritum: ik weer/was, du weerst/wast, he, se, dat weer/was; Wi/ji/se weern/wassen\nFutur: ik s(ch)all sien/wesen; du schallst/schasst/sallst/sullt sien/wesen; he, se, dat s(ch)all sien/wesen; Wi/ji/se schallen/s(ch)ölen sien/wesen.\nPartizip: ween/wesen/west\nImperativ: wees!, weest! / sie!, sied!\nschölen/sölen\nPräsens: ik s(ch)all; du s(ch)allst/schasst; he, se, dat s(ch)all; wi, ji, se schallt/sallen\nPräteritum: ik s(ch)ull; du s(ch)ullst/schuss; he, se, dat schull; wi, ji, se schullen\nFutur: bruukt keeneen\nPartizip: schullt\nImperativ: schall! schallt!\nhebben\nPräsens: ik heff/hebb; du hest; he, se, dat hett; wi, ji, se hebbt/hebben\nPräteritum: ik harr; du harrst; he, se, dat harr; wi, ji, se harrn\nFutur: ik schall hebben; du schallst hebben; he, se, dat schall hebben; wi, ji, se schallt hebben\nPartizip: hatt\nImperativ: hebb!, hebbt!\n\nDat Perfekt\nDat warrt tomeist mit hebben mookt. Achteran kümmt dat Partizip vun dat eegentlich Verb. Dat hebben warrt konjugeert un dat Partizip nich: Ik hebb slapen, Du hest slapen, he hett slapen, wi hebbt slapen ...\n\nDat Hööftwoort\n1. Dat Geslecht is bi welke Hööftwöör nich eendüdig fastleggt, un dat stimmt nich ümmer mit de hoochdüütschen Formen övereen.\nBispelen:\n\nde Band, dat Band\nde Huck, dat Huck\nde Schiet, dat Schiet\nde Töller, dat Töller\nde Markt, dat Markt\nde Sand, dat Sand\nde Dook, dat Dook\nde Minsch, dat Minsch\nde Gammel, dat Gammel\n\nDat Bögen von de Hööftwöör\nDe Hööftwöör warrt mehrstiets nich böögt.\nBlots bi de männlichen Hööftwöör warrt de 3. un de 4. Fall dör den Artikel den markeert (Utspraken warrt den so as denn [dɛn]) un in mannigwücken Dialekten warrt de 3. un 4. Fall bi swacken maskulinen Hööftwöör mit enen -en Suffix markert (t.B. de Os → den Ossen (Dat. & Akk.)).\nDe twete Fall warrt bi Personennaams dör een '-s' Suffix markert (Schosters Kinner, Pasters Veeh), man anners dör Konstrukschonen as Vadder sien Piep or Oma ehr Huus henstellt.\nIn all de annern Fäll blievt de Artikels de un dat unverännert bestahn.\nDe echte twete Fall gifft 't noch bi Dag- un Tiedangaven, so heet dat ’s Nachts un enes Dags. Dat Verkörten vun den Artikel is dorbi gang un geev.\nAf un to warrt de twete Fall ook bi bestimmten Mengdeangaven bruukt (t.B. twee Pund Appels staats twee Pund vun de Appels).\nVergliek vun de hochdüütsche un plattdüütsche Artikels:\n\nAn wenige Woortresten kann man vandage noch sehn, dat dat fröher ok enen tweten un drüdden Fall geven hett, to’n Bispill: wieldes, dat is nich andem, buterdem ahndem kaam ik nich ut. En anner Relikt is de Dativ bi manke neutrale Wöör. So gifft dat bi welke fasten Utdrücken mit en saaklichet Woort in de Kortform vun de bestimmten Artikel en Dativ-n: to'n Bispeel. Aver dit Prinzip warrt ok faken op nich faste Utdrücken anwannt, wenn de Artikel in de Kortform steiht: Ik gah to'n Spelen rut. In de Langform warrt dat aver wedder de kasusfre'e Artikel: Ik gah to dat Spelen rut. Of düsse Formen nu mit de Utspraakökonomie tohoophangt, en Överreguleren is oder vun dat Hoochdüütsche kaamt un de Nasal to immiteren versöökt, kann nich nipp un nau seggt warrn.\n\nDe Mehrtall\nDe Mehrtall köönt de plattdüütschen Wöör up verschedene Wies billen. Överlangs gifft dat för een un dat sülve Woort twee Formen, un faken is de Mehrtall denn anners as in dat Hoochdüütsche.\nBispelen\n\nEentall un Mehrtall stimmt övereen: de Knaken - de Knaken, dat Been - de Been\nBookstaven kaamt darto: de Disch - de Dischen, dat Oog - de Ogen, dat Kleed - de Kleder\nen \"s\" warrt anhungen: de Arm - de Arms, de Deern - de Deerns\nde Stammvokaal warrt Umluut: de Slag - de Slääg,  de Goos - de Göös, dat Huus - de Hüüs\nde Stammvokaal warrt länger: de Dag - de Daag - dat Brett - de Breed\nWat dat in de noorden Dialekten vun dat Plattdüütsche nich gifft, is de hoochdüütsche Mehrtall op -e. (Dor wo fröher mal en -e weer, is dat verswunnen, as HD: Lampe → Platt: Lamp). Un so kann -e as Plural nich richtig ween. Bi disse Wöör warrt de Plural faken op -en billt. Bispelen: een Andeel →> twee Andelen, een Blitz → twee Blitzen, een Programm → twee Programmen, een Konzept → twee Konzepten.\n\nPronomina - Förwöör\nBi de persöönlichen un besittanwiesen Förwöör gifft dat för jedet Geslecht blots twee Fälle. De 3. und de 4. Fall sünd in ene Form vereent (nich alltiet in Oostfäälsch), de 2. Fall warrt umschreven,\n\nPersöönliche Förwöör\nBesittanwiesen Förwöör\nHenwiesen Förwöör\nAdjektive - Egenschapswöör\nBi de Flexion (dat Bögen) von Egenschapswöör gifft dat in't Plattdüütsche verschedene Formen. Se laat sik aver nich na bestimmte Dialektrebetten un ok nich na richtig oder verkehrt unnerscheden. Man faken is dat denn doch nich so ünnerscheedlich, dennso gifft 't mehr or minner een Schema.\nDe Egenschapswöör wardt in dree Aarten indeelt. Dor gifft dat de starken Egenschapswöör, de swacken Egenschapswöör un de nich böögten Egenschapswöör.\nDe eersten twee bruukt een, wenn dat Egenschapswoort an een attributive un adsubstantivsche Stell steiht.\n\nde Swacken\nEen bruukt de swacken Egenschapswöör wenn dor een bestimmten Artikel, een henwiesenet Förwoort (Demonstrativpronomen) or wat Vergliekboors vör steiht.\nSe hebbt twee Suffixen: -en (för de Mehrtall un för den Dativ un Akkusativ bi maskulinen Hööftwöör) un -e (för de annern Fäll).\nMan in mannigwücken Dialekten wardt disse nich mehr böögt. (Dordör dat de Artikel or dat Pronomen al de grammatsche Funkschoon henstellt.)\n\nde Starken\nDe starken Egenschapswöör bruukt een, wenn dor keen Artikel un Förwoort, keen bestimmten Artikel or so dorvör steiht, man dat Egenschapswoort liekers an een attributive un adsubstantivsche Stell steiht.\nDat gifft hier dree Suffixen: -en (för de Eentall bi Maskulina), -et/es (för de Eentall bi Neutra) un -e (för all annern).\nOok hier is dat so, datt een in mannigwücken Dialekten disse nich böögt, wenn dor de nich bestimmte Artikel steiht. (Man faken doch, wenn dor keen Artikel steiht t.B. een lütt Gaarn man lütten Gaarn)\n\nSteiht dor keen Förwoort or keen Artikel, denn gifft dat noch ene twete Art dat Egenschapsword to bögen.\n\nResten vun den Genitiv\nOk bi de Egenschapswöör gifft dat noch Resten vun den Genitiv — as bi de Hööftwöör.\nFaken sünd dat Resten in Sprickwöör or Seggwiesen. (t.B.: enes goden Dags)\nEen bruukt den Genitiv vun Egenschapswöör ok denn, wenn se bi bestimmten Mengdeangaven staht. (Bi de Mehrtall is he man nich mehr uteneentokennen vun de annern Fäll) \nDe Enn is jümmer -en bi swacken un starken Egenschapswöör.\nDe Genitiv kann nich adverbial in'n Satz stahn.\n\nde nich böögten Wöör\nSe wardt bruukt in Fäll as t.B. Dat Huus is lütt un is denn adverbial or prädikativ (also een Deel vun'n Prädikaat).\n\nBispelen\nFör all dree Geslechter kann aver ok de Form ahne jede Endung bruukt weern:\nde ool Buck - de ool Koh - dat ool Wiev\nDe Stiegformen (hooch, höger, hööchste) weert dör de Endungen -er un -ste billt, de Superlativ ((t.B. am besten) warrt mit an'n oder up't. (\"He kunn dat an'n besten\" oder  \"He kunn dat up't best.\")\n\nPräpositionen\nPräpositionen sünd: aower, achter, an, baoven, bi, bilangs, in, binnen, dal, dör, gegen, hendör, langs, na, noast, op, twüschen, ünner, ut, vör, vun, too, roond um, up too, vun of; jensiets (+ Gen.).\n\nLiteratur\nGerold Meiners: Plattdüütsch in sess Weken, en Lees -un Lehrbook för Anfängers un Kunnige, Isensee Verlag Ollnborg\nKarl Fissen: Plattdüütsch läwt, Ollnborg 1963\n\nWeblenken\nPlattdüütsche Grammatik online (plattdüütsch)\"\nBidde maak 5 Fragen up plattdüütsch, de den Inholt vun dissen Text so goot as mööglich afdeckt. Dann antwoorst du op de Fragen.<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\nFragen:\n\n1. Wo hett dat mit den Artikel in't Plattdüütsche to doon? \n2. Wie warrt de Konjugatschoon von Verben in't Plattdüütsche billt? De Verben warrt konjugeert, wat dat meent?\n3. Wo hett dat mit den Tied bi Verben to doon? Gifft dat Präsens, Präteritum, Perfekt un Plusquamperfekt, oder gifft dat noch annere Tieden?\n4. Wie warrt de Hülpsverben in't Plattdüütsche bruukt? \n5. Wo hett dat mit den Mehrtall to doon in't Plattdüütsche? \n\nAntwoorten:\n\n1.  De Artikel sünd nich so as in't Hoochdüütsche, man dor gifft ok Resten vun den Genitiv un ok een Form ahne jede Endung.\n2.  Dat heet, dat se sik ännert. Wenn ik wat do heet dat anners ans wenn du dat deist oder se dat doot oder gor wenn ik wat doon harr. Dat heet, dat kümmt dorop an, welk Person dat is, wat dat Eentall oder Mehrtall is un vör allens, wat för en Tiet dat is.\n3.  Ja, dat gifft dat. De Präsens is för dat, wat nu is. Dat Präteritum is för dat, wat weer (verleden Tiet). Dat Perfekt is för dat, wat jüst vörbi is un dat Plusquamperfekt is för dat, wat all lang vörbi is.\n4.  De Hülpsverben sünd: sien/wesen, hebben, wullen, schallen (sallen), doon, warrn, könen, mögen, möten, dörven. De Hülpsverben hebbt t.B. mit de Tied to doon.\n5.  De Mehrtall köönt de plattdüütschen Wöör op verschedene Wies billen, un faken is de Mehrtall denn anners as in dat Hoochdüütsche. Bi de Mehrtaal gifft dat mehr or minner een Schema. De Enn is jümmer -en bi swacken un starken Egenschapswöör.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\n\""

templateEnd = "\"\nBidde maak 5 Fragen up plattdüütsch, de den Inholt vun dissen Text so goot as mööglich afdeckt. Dann antwoorst du op de Fragen.<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\nFragen:\n\n1."

def generate_text(server_url, artikel, max_tokens=100):
    """
    Generate text from a prompt using a llama.cpp server.
    
    :param server_url: URL of the llama.cpp server
    :param prompt: Input prompt for text generation
    :param max_tokens: Maximum number of tokens to generate
    :return: Generated text
    """

    prompt = templateStart + artikel + templateEnd
    print(prompt)
    payload = {
        "prompt": prompt,
        "temperature": 0.1,
        "min_p": 0.05,
        "repeat_penalty": 1.1,
    }
    
    try:
        response = requests.post(f"{server_url}/completion", json=payload)
        response.raise_for_status()
        result = response.json()
        return result.get('content', '')
    except requests.RequestException as e:
        print(f"Error generating text: {e}")
        return ''


# Example usage
server_url = "http://localhost:8080"

for file in os.listdir("./wikiArtikel/"):
    with open("./wikiArtikel/" + file, "r") as textfile:
        newWikiArtikel = textfile.read()
        generated_text = generate_text(server_url, newWikiArtikel)
        print("Generated Text:")
        print(generated_text)

